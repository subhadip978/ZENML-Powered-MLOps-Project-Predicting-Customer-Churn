import{j as s,r as p}from"./@radix-BXWm7HOa.js";import{R as u}from"./refresh-COb6KYDi.js";import{k as d,l as h,j as f,n as x,F as g,m as j,r as o,T as P,z as r,o as y,P as b,h as N,D as v,S as l}from"./index-DhIZtpxB.js";import{S as w,P as S}from"./SearchField-C9R0mdaX.js";import{q as E,a as T}from"./@tanstack-FmcYZMuX.js";import{o as C}from"./url-hcMJkz8p.js";import{S as _}from"./terminal-grtjrIEJ.js";import{C as F}from"./CopyButton-Dbo52T1K.js";import{g as R,E as L}from"./ExecutionStatus-jH4OrWBq.js";import{L as c,c as k}from"./@react-router-l3lMcXA2.js";import"./@reactflow-CeVxyqYT.js";import"./dots-horizontal-sKQlWEni.js";import"./chevron-right-double-Dk8e2L99.js";import"./index-Bd1xgUQG.js";import"./copy-f3XGPPxt.js";import"./check-circle-1_I207rW.js";async function q({params:e}){const t=d(h.pipelines.all+"?"+C(e)),a=await f(t,{method:"GET",headers:{"Content-Type":"application/json"}});if(a.status===404&&x(),!a.ok)throw new g({message:"Error while fetching pipelines",status:a.status,statusText:a.statusText});return a.json()}const m={all:["pipelines"],pipelineList:e=>E({queryKey:[...m.all,e],queryFn:async()=>q({params:e})})};function z(){return[{id:"name",header:"Pipeline",accessorFn:e=>{var t;return{name:e.name,status:(t=e.body)==null?void 0:t.latest_run_status}},cell:({getValue:e})=>{const{name:t,status:a}=e();return s.jsxs("div",{className:"group/copybutton flex items-center gap-2",children:[s.jsx(j,{className:`h-5 w-5 ${R(a)}`}),s.jsxs(c,{to:o.pipelines.namespace(encodeURIComponent(t)),className:"flex items-center gap-1",children:[s.jsx("h2",{className:"text-text-md font-semibold",children:t}),s.jsx(L,{status:a}),s.jsx(F,{copyText:t})]})]})}},{id:"latest-run",header:"Latest Run",accessorFn:e=>{var t,a;return{status:(t=e.body)==null?void 0:t.latest_run_status,runId:(a=e.body)==null?void 0:a.latest_run_id}},cell:({getValue:e})=>{const{runId:t,status:a}=e();return!t||!a?s.jsx("div",{children:"No run"}):s.jsx(c,{to:o.runs.detail(t),children:s.jsxs(P,{emphasis:"subtle",rounded:!1,className:"inline-flex items-center gap-0.5",color:B(a),children:[s.jsx(_,{className:`h-3 w-3 ${A(a)}`}),t==null?void 0:t.split("-")[0]]})})}}]}function A(e){if(!e)return"fill-theme-text-brand";switch(e){case"running":return"fill-orange-700";case"cached":return"fill-theme-text-secondary";case"completed":return"fill-success-800";case"failed":return"fill-error-800";case"initializing":return"fill-theme-text-brand"}}function B(e){if(!e)return"purple";switch(e){case"running":return"orange";case"cached":return"grey";case"completed":return"green";case"failed":return"red";case"initializing":return"purple"}}const i=1,D=r.object({page:r.coerce.number().min(i).optional().default(i).catch(i),name:r.string().optional(),operator:r.enum(["and","or"]).optional()});function I(){const[e]=k(),{page:t,name:a,operator:n}=D.parse({page:e.get("page")||void 0,name:e.get("name")||void 0,operator:e.get("operator")||void 0});return{page:t,name:a,logical_operator:n}}function te(){const{setCurrentBreadcrumbData:e}=y(),t=I(),{data:a,refetch:n}=T({...m.pipelineList({...t,sort_by:"desc:latest_run"}),throwOnError:!0});return p.useEffect(()=>{e({segment:"pipelines",data:null})},[]),s.jsxs("div",{children:[s.jsx(b,{children:s.jsx("h1",{className:"text-display-xs font-semibold",children:"Pipelines"})}),s.jsx("section",{className:"p-5",children:s.jsxs("div",{className:"flex flex-col gap-5",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(w,{searchParams:t}),s.jsx("div",{className:"flex justify-between",children:s.jsxs(N,{intent:"primary",emphasis:"subtle",size:"md",onClick:()=>n(),children:[s.jsx(u,{className:"h-5 w-5 fill-theme-text-brand"}),"Refresh"]})})]}),s.jsxs("div",{className:"flex flex-col items-center gap-5",children:[s.jsx("div",{className:"w-full",children:a?s.jsx(v,{columns:z(),data:a.items}):s.jsx(l,{className:"h-[500px] w-full"})}),a?a.total_pages>1&&s.jsx(S,{searchParams:t,paginate:a}):s.jsx(l,{className:"h-[36px] w-[300px]"})]})]})})]})}export{te as default};
